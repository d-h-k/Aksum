# 당근마켓 분석하기 TMI

## 당근마켓이 중고물건을 생각하는 방식
- 당근마켓은 중고물건 판매글을, 물품을 올리는 goods 의 관점이 아니라, 글을 올린다는 관점의 article로 접근한다

![판매글이미지](https://user-images.githubusercontent.com/31065684/149781264-52104ef0-9e20-4e8d-a0aa-e67798f5d609.png)
- 여기서 포인트는 
  - 당근마켓은 중고판매글을 `article` 로 인식한다
  - 관심, 채팅, 조회수가 표시되는데 여기서 채팅은 거래글을 중심으로 생성된다
  - 게시시간은 끌어올림 글 기준으로 계산한다

### 당근마켓과 중고나라의 전략차이
- 당근마켓은 중고판매글을 `article` 로 인식한다. 글올리는 행위에 중점을 두고 >> 지역사람들 끼리 글을 올리고 물건을 교환한다는 


## 당근마켓은 지역을 어떻게 다룰까?
- 서울시는 구단위, 나머지는 시군구로 크게 나뉘고 중간중간에 Dummy Number가 끼어있다. 노가다로 직접 구해본 데이터들을 소개하면

###  regions_id 는 Primary-Key 로 동작하고 "동" 단위로 인식한다

| regions_id | 지역             |
| ---------- | ---------------- |
| 177        | 노원구 중계본동  |
| 178        | 노원구 중계1동   |
| 179        | 노원구 중계4동   |
| 180        | 노원구 중계2,3동 |
| 135        | 월곡2동          |
| 1604       | 별내동           |
| 6078       | 방학동           |
- 노원구에서 가장 가까운 서울시내 다른 구(월곡2동, 방학동), 경기도 인접(별내동) 번호는 크게 차이가 난다
- 결론 : regions_id 는 `고유키` 로 동작한다

### regions_id 의 숫자값에 가중치나 의미가 없다. 가까운 동네일지라도 광역시가 다르면 큰차이가 난다

| regions_id | 지역                |
| ---------- | ------------------- |
| 1351       | 성남시 삼평동(판교) |
| 1347       | 성남시 야탑2동      |
| 1352       | 성남시 백현동       |
| 4538       | 수원시 이의동       |
| 4535       | 수원시 매탄동       |

- 당근마켓의 발상지(..?) 라고 할수 있는 판교와 그 옆 수원시를 찍어봤는데 regions_id 숫자에 큰 차이가 있었다. PK 의 Ordinal에 의미가 있지는 않은듯


### regions_id 의 자릿수에도 의미가 없다

| regions_id | 지역            |
| ---------- | --------------- |
| 1          | 서울시 (더미)   |
| 11         | 중구 1234가동   |
| 111        | 중랑구 중랑동   |
| 1111       | 대전광역시 동구 |
| 2          | 중구 (더미)     |
| 22         | 중구 회현동     |
| 222        | 마포구 아현동   |

- 1,11,111,1111 사이의 지역들간 아무런 연관이 없다
- 2,22,222 도 마찬가지

### 연속된 숫자로 시/군/구 를 구분하며 중간중간에 더미PK가 끼여있다

| regions_id | 지역              |
| ---------- | ----------------- |
| 1          | 서울특별시 (더미) |
| 2          | 중구 (더미)       |
| 3          | 중구 청운효자동   |
| 22         | 중구 회현동       |
| 22 ~ 33    | 중구 @@동         |
| 34         | 중구 황학동       |
| 35         | 중구 중림동       |
| 36         | 용산구 (더미)     |
| 37         | 용산구 후암동     |
| 38~51      | 용산구 @@동       |
| 52         | 용산구 보광동     |
| 53         | 서울 성동구 (더미) |
| 54         | 서울 성동구 왕십리제2동 |

- 35,36,37번을 보면 중구 >> 용산구로 넘어가는데 중간에 35번 용산구더미가 끼여있다.
- 중간중간에 사용하지않는 지역을 끼워놓는 이유는 혹시나 모를 행정구 분할등을 대비함이 위함이 아닐까?!
  - 아니라면.. 왜 더미들이 끼여있는지는 잘 모르겠다. 뭐 물론 RDB 상에 저런 레코드 한두줄 더 끼여있는다고해서 큰 영향이 있을꺼같진 않다. 대충 계산해봐도 레코드가 0.3% 정도 늘어나는데 불과하므로


### 번외 : 두 지점 사이의 거리(근처인지 아닌지 판별하기 위해)
- 성남시와 수원시는 인접시인데, 성남시 백현동과(1347) 수원시 이의동(4538)사이의 Ordinal 차이는 크다. 
- 물리적인 두 지점 사이의 거리를 구하는 방법은 추측하건데 지도 API 로 기준점 좌표를 받아 >> 두점사이의 거리를 구하는 방식이 가장 쉽고 편하게 구할듯 하다..
  - 어차피 두 지점 사이의 거리는 변하지 않으니 Matrix 형식으로 요청해놓고 caching 해서 사용하면 될듯?
- 당근마켓은 카카오맵 API를 사용하니 "길이재기" 기능을 사용하면 반경 X Km 까지 가능! 이런식의 서비스가 가능할꺼같다
